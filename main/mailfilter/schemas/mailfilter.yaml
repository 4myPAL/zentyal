class: 'EBox::MailFilter'
enabledepends:
    - mail
    - antivirus

depends:
    - mail
    - antivirus

models:
    - AmavisConfiguration
    - AmavisPolicy
    - ExternalMTA
    - ExternalDomain
    - VDomainsFilter
    - FileExtensionACL
    - MIMETypeACL
    - AntispamConfiguration
    - AntispamACL
    - AntispamTraining
    - AntispamVDomainACL
    - FilterDetails
    - FilterGraph
    - FilterReportOptions

composites:
    Amavis: [AmavisConfiguration, AmavisPolicy, VDomainsFilter, ExternalConnections]
    ExternalConnections: [ExternalMTA, ExternalDomain]
    FileFilter: [FileExtensionACL, MIMETypeACL]
    Antispam: [AntispamConfiguration, AntispamACL, AntispamTraining]
    FilterReport: [FilterReportOptions, FilterGraph, FilterDetails]

modeldepends:
    VDomainsFilter:
        mail/VDomains: [vdomain]

foreign:
    VDomainsFilter: [AntispamVDomainACL]
